// Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
using System;
using System.Collections.Generic;
using Kreuzberg;
using Xunit;
using Kreuzberg.E2E;

namespace Kreuzberg.E2E.Office {
    public class OfficeTests
    {
        [Fact]
        public void OfficeDocLegacy()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("legacy_office/unit_test_lists.doc");
            var result = TestHelpers.RunExtraction("legacy_office/unit_test_lists.doc", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/msword" });
            TestHelpers.AssertMinContentLength(result, 20);
        }

        [Fact]
        public void OfficeDocxBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("office/document.docx");
            var result = TestHelpers.RunExtraction("office/document.docx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.wordprocessingml.document" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [Fact]
        public void OfficeDocxEquations()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("documents/equations.docx");
            var result = TestHelpers.RunExtraction("documents/equations.docx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.wordprocessingml.document" });
            TestHelpers.AssertMinContentLength(result, 20);
        }

        [Fact]
        public void OfficeDocxFake()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("documents/fake.docx");
            var result = TestHelpers.RunExtraction("documents/fake.docx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.wordprocessingml.document" });
            TestHelpers.AssertMinContentLength(result, 20);
        }

        [Fact]
        public void OfficeDocxFormatting()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("documents/unit_test_formatting.docx");
            var result = TestHelpers.RunExtraction("documents/unit_test_formatting.docx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.wordprocessingml.document" });
            TestHelpers.AssertMinContentLength(result, 20);
        }

        [Fact]
        public void OfficeDocxHeaders()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("documents/unit_test_headers.docx");
            var result = TestHelpers.RunExtraction("documents/unit_test_headers.docx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.wordprocessingml.document" });
            TestHelpers.AssertMinContentLength(result, 20);
        }

        [Fact]
        public void OfficeDocxLists()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("documents/unit_test_lists.docx");
            var result = TestHelpers.RunExtraction("documents/unit_test_lists.docx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.wordprocessingml.document" });
            TestHelpers.AssertMinContentLength(result, 20);
        }

        [Fact]
        public void OfficeDocxTables()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("documents/docx_tables.docx");
            var result = TestHelpers.RunExtraction("documents/docx_tables.docx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.wordprocessingml.document" });
            TestHelpers.AssertMinContentLength(result, 50);
            TestHelpers.AssertContentContainsAll(result, new[] { "Simple uniform table", "Nested Table", "merged cells", "Header Col" });
            TestHelpers.AssertTableCount(result, 1, null);
        }

        [Fact]
        public void OfficePptLegacy()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("legacy_office/simple.ppt");
            var result = TestHelpers.RunExtraction("legacy_office/simple.ppt", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.ms-powerpoint" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [Fact]
        public void OfficePptxBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("presentations/simple.pptx");
            var result = TestHelpers.RunExtraction("presentations/simple.pptx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.presentationml.presentation" });
            TestHelpers.AssertMinContentLength(result, 50);
        }

        [Fact]
        public void OfficePptxImages()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("presentations/powerpoint_with_image.pptx");
            var result = TestHelpers.RunExtraction("presentations/powerpoint_with_image.pptx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.presentationml.presentation" });
            TestHelpers.AssertMinContentLength(result, 20);
        }

        [Fact]
        public void OfficePptxPitchDeck()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("presentations/pitch_deck_presentation.pptx");
            var result = TestHelpers.RunExtraction("presentations/pitch_deck_presentation.pptx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.presentationml.presentation" });
            TestHelpers.AssertMinContentLength(result, 100);
        }

        [Fact]
        public void OfficeXlsLegacy()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("spreadsheets/test_excel.xls");
            var result = TestHelpers.RunExtraction("spreadsheets/test_excel.xls", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.ms-excel" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [Fact]
        public void OfficeXlsxBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("spreadsheets/stanley_cups.xlsx");
            var result = TestHelpers.RunExtraction("spreadsheets/stanley_cups.xlsx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
            TestHelpers.AssertMinContentLength(result, 100);
            TestHelpers.AssertContentContainsAll(result, new[] { "Team", "Location", "Stanley Cups" });
            TestHelpers.AssertTableCount(result, 1, null);
            var metadataNode = TestHelpers.MetadataToJson(result.Metadata);
            TestHelpers.AssertMetadata(metadataNode, "sheet_count", @"{""gte"": 2}");
            TestHelpers.AssertMetadata(metadataNode, "sheet_names", @"{""contains"": [""Stanley Cups""]}");
        }

        [Fact]
        public void OfficeXlsxMultiSheet()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("spreadsheets/excel_multi_sheet.xlsx");
            var result = TestHelpers.RunExtraction("spreadsheets/excel_multi_sheet.xlsx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
            TestHelpers.AssertMinContentLength(result, 20);
            var metadataNode = TestHelpers.MetadataToJson(result.Metadata);
            TestHelpers.AssertMetadata(metadataNode, "sheet_count", @"{""gte"": 2}");
        }

        [Fact]
        public void OfficeXlsxOfficeExample()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("office/excel.xlsx");
            var result = TestHelpers.RunExtraction("office/excel.xlsx", null);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

    }
}
