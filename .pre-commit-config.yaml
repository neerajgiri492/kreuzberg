default_install_hook_types:
  - pre-commit
  - commit-msg
exclude: ^docs/snippets/|vendor/|node_modules/|target/|v3/|invalid*

repos:
  - repo: https://github.com/Goldziher/gitfluff
    rev: v0.7.0
    hooks:
      - id: gitfluff-lint
        args: ["--write"]
        stages: [commit-msg]
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-merge-conflict
      - id: check-added-large-files
        exclude: uv.lock
      - id: detect-private-key
      - id: check-json
      - id: check-yaml
        args: ["--allow-multiple-documents"]
      - id: check-toml
      - id: check-case-conflict
  - repo: local
    hooks:
      # TOML Formatting - using task command
      - id: toml-format
        name: Format TOML files
        entry: task toml:format
        language: system
        files: \.toml$
        pass_filenames: false
        require_serial: true
      # Python Linting and Formatting - using task commands
      - id: python-lint-check
        name: Check Python linting (ruff + mypy)
        entry: task python:lint:check
        language: system
        types: [python]
        pass_filenames: false
        require_serial: true
        stages: [commit]
      - id: python-format
        name: Format Python code
        entry: task python:format
        language: system
        types: [python]
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # Rust Linting and Formatting - using task commands
      - id: rust-format-check
        name: Check Rust formatting
        entry: task rust:format:check
        language: system
        files: ^(crates|tools|e2e/rust)/.*\.rs$|^(Cargo\.toml|Cargo\.lock|crates/.*/Cargo\.toml|tools/.*/Cargo\.toml|e2e/rust/Cargo\.toml|packages/ruby/ext/kreuzberg_rb/native/Cargo\.toml)$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      - id: rust-lint-check
        name: Check Rust linting (clippy)
        entry: task rust:lint:check
        language: system
        files: ^(crates|tools|e2e/rust)/.*\.rs$|^(Cargo\.toml|Cargo\.lock|crates/.*/Cargo\.toml|tools/.*/Cargo\.toml|e2e/rust/Cargo\.toml|packages/ruby/ext/kreuzberg_rb/native/Cargo\.toml)$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # Rust dependency licenses - using task command
      - id: rust-licenses
        name: Check Rust dependency licenses
        entry: task rust:licenses
        language: system
        files: ^(Cargo\.toml|Cargo\.lock|crates/.*/Cargo\.toml|tools/.*/Cargo\.toml|e2e/rust/Cargo\.toml|packages/ruby/ext/kreuzberg_rb/native/Cargo\.toml|deny\.toml)$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # Node/TypeScript Linting and Formatting - using task commands
      - id: node-format-check
        name: Check TypeScript formatting (biome)
        entry: task node:format:check
        language: system
        files: ^crates/kreuzberg-node/
        pass_filenames: false
        require_serial: true
        stages: [commit]
      - id: node-lint-check
        name: Check Node/TypeScript linting
        entry: task node:lint:check
        language: system
        files: ^crates/kreuzberg-node/
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # Ruby Linting and Formatting - using task commands
      - id: ruby-format-check
        name: Check Ruby formatting (rubocop)
        entry: task ruby:format:check
        language: system
        files: ^packages/ruby/.*\.rb$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      - id: ruby-lint-check
        name: Check Ruby linting (rubocop + steep)
        entry: task ruby:lint:check
        language: system
        files: ^packages/ruby/(lib|sig)/.*\.(rb|rbs)$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # Go Linting and Formatting - using task commands
      - id: go-format-check
        name: Check Go formatting
        entry: task go:format:check
        language: system
        files: ^packages/go/v4/.*\.go$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      - id: go-lint-check
        name: Check Go linting (golangci-lint)
        entry: task go:lint:check
        language: system
        files: ^packages/go/v4/
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # Java Linting and Formatting - using task commands
      - id: java-format-check
        name: Check Java formatting (spotless)
        entry: task java:format:check
        language: system
        files: ^packages/java/src/.*\.java$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      - id: java-lint-check
        name: Check Java linting (checkstyle + pmd)
        entry: task java:lint:check
        language: system
        files: ^packages/java/src/.*\.java$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # C# Linting and Formatting - using task commands
      - id: csharp-format-check
        name: Check C# formatting (dotnet format)
        entry: task csharp:format:check
        language: system
        files: ^packages/csharp/
        pass_filenames: false
        require_serial: true
        stages: [commit]
      - id: csharp-lint-check
        name: Check C# linting (dotnet format verify)
        entry: task csharp:lint:check
        language: system
        files: ^packages/csharp/
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # PHP Linting and Formatting - using task commands
      - id: php-format-check
        name: Check PHP formatting (php-cs-fixer)
        entry: task php:format:check
        language: system
        files: ^packages/php/.*\.php$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      - id: php-lint-check
        name: Check PHP linting (phpstan + php-cs-fixer)
        entry: task php:lint:check
        language: system
        files: ^packages/php/.*\.php$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # Shell scripts linting - using task command
      - id: shell-lint-check
        name: Check shell scripts (shfmt + shellcheck)
        entry: task shell:lint:check
        language: system
        files: \.sh$
        pass_filenames: false
        require_serial: true
        stages: [commit]
      # GitHub Actions linting - using task command
      - id: github-actions-lint
        name: Lint GitHub Actions workflows (actionlint)
        entry: task github:lint
        language: system
        files: ^\.github/workflows/.*\.ya?ml$
        pass_filenames: false
        require_serial: true
        stages: [commit]
